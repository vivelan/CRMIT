["{}","{\"nodes\":{\"FORMULA6\":{\"sources\":[\"FORMULA5\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"Weighted_NE_per_Ton + (AVG_ForecastNetProceeds__c - \\\"LastMonth.AVG_ActualNetProceeds__c\\\")\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Forecast_NE\",\"scale\":2,\"label\":\"Forecast NE (\\u20ac/t)\",\"type\":\"NUMBER\"}]}},\"FORMULA7\":{\"sources\":[\"FORMULA6\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"case Total_Internal_Cost\\r\\n\\twhen 0\\r\\n\\tthen null\\r\\n\\telse Forecast_NE - Total_Internal_Cost\\r\\nend\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Forecast_PE\",\"scale\":2,\"label\":\"Forecast PE (\\u20ac/t)\",\"type\":\"NUMBER\"}]}},\"FORMULA8\":{\"sources\":[\"AGGREGATE11\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat('01', '/', ForecastTimePoint__c_MONTH, '/', ForecastTimePoint__c_YEAR)\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"ForecastTimePoint__c\",\"label\":\"Forecast Time Point\",\"type\":\"TEXT\"}]}},\"FORMULA9\":{\"sources\":[\"FORMULA1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat('01/', Created_Date_MONTH, '/', Created_Date_YEAR)\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"COPA_Last_Updated_Date\",\"label\":\"COPA Last Updated Date\",\"type\":\"TEXT\"}]}},\"AGGREGATE11\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"AVG_ActualNetProceeds__c\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"AVG_ForecastNetProceeds__c\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":5,\"type\":\"NUMBER\"}},\"name\":\"SUM_ForecastSoldAmount__c\"}]},\"sources\":[\"EXTRACT5\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Account__c\",\"ForecastTimePoint__c_MONTH\",\"ForecastTimePoint__c_YEAR\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"AVG_ActualNetProceeds__c\",\"action\":\"AVG\",\"source\":\"ActualNetProceeds__c\",\"label\":\"Average Actual Net proceeds\"},{\"name\":\"AVG_ForecastNetProceeds__c\",\"action\":\"AVG\",\"source\":\"ForecastNetProceeds__c\",\"label\":\"Average Forecast Net proceeds\"},{\"name\":\"SUM_ForecastSoldAmount__c\",\"action\":\"SUM\",\"source\":\"ForecastSoldAmount__c\",\"label\":\"Sum of Forecast sold amount\"}]}},\"DROP_FIELDS0\":{\"sources\":[\"JOIN1\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Created_Date_MONTH\",\"Aggregate4.Customer_Key\",\"SUM_Net_Proceeds\",\"Aggregate4.SUM_Quantity_t\",\"Frequency__c\",\"ForecastLevel__c\",\"Aggregate4.Customer_Name\",\"Customer_Name\"]},\"fields\":[]}},\"LOAD_DATASET1_copy0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Name\",\"SAPAccountNumber__c\",\"Id\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"sourceObjectName\":\"Account\",\"label\":\"Account\",\"connectionName\":\"SFDC_LOCAL\",\"type\":\"connectedDataset\"}}},\"DROP_FIELDS4\":{\"sources\":[\"FILTER5\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"BusinessArea__c\",\"ForecastSoldAmount__c\",\"ForecastNetProceeds__c\",\"ForecastLevel__c\",\"Frequency__c\",\"Name\",\"SAPAccountNumber__c\",\"Id\",\"SUM_ForecastNetProceeds__c\",\"SUM_ForecastSoldAmount__c\",\"AVG_ForecastNetProceeds__c\",\"ForecastTimePoint__c\"]},\"fields\":[]}},\"DROP_FIELDS3\":{\"sources\":[\"FORMULA7\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"SUM_Quantity_t\",\"Weighted_NE_per_Ton\",\"Percentage_Quantity\",\"material_no\",\"Forecast_Date\",\"DeltaNetProceeds__c\",\"ForecastSoldAmount__c\",\"Created_Date_YEAR\",\"Account__c\",\"AVG_ActualNetProceeds__c\",\"AVG_ForecastNetProceeds__c\",\"LastMonth.AVG_ActualNetProceeds__c\",\"SUM_ForecastSoldAmount__c\",\"LastMonth.AVG_ForecastNetProceeds__c\",\"Total_External_Cost\",\"Total_Internal_Cost\",\"Id\"]},\"fields\":[]}},\"DROP_FIELDS2\":{\"sources\":[\"TO_DATE0\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"price_point_year\",\"price_point_month\"]},\"fields\":[]}},\"DROP_FIELDS1\":{\"sources\":[\"FORMULA3\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"SELECT\",\"ignoreMissingFields\":true,\"fields\":[\"material_no\",\"price_point_year\",\"price_point_month\",\"Total_External_Cost\",\"Total_Internal_Cost\"]},\"fields\":[]}},\"DROP_FIELDS5\":{\"sources\":[\"TO_DATE1\"],\"action\":\"schema\",\"parameters\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ForecastTimePoint__c_DAY\",\"ForecastTimePoint__c_MONTH\",\"ForecastTimePoint__c_YEAR\"]},\"fields\":[]}},\"OUTPUT0\":{\"sources\":[\"DROP_FIELDS3\"],\"action\":\"save\",\"parameters\":{\"measuresToCurrencies\":[],\"fields\":[],\"dataset\":{\"name\":\"Net_Proceeds_Analysis\",\"label\":\"Net Proceeds Analysis\",\"folderName\":\"Pricing_Dashboards_Sales_Marketing\",\"type\":\"analyticsDataset\"}}},\"LOAD_DATASET3\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"id\",\"material_no\",\"alternate_basic_plan\",\"category_1\",\"category_2\",\"category_3\",\"price_point_year\",\"price_point_month\",\"internal_cost\",\"external_cost\",\"fixed_cost\",\"quantity_child_material\",\"child_material_no\",\"last_updated\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"sourceObjectName\":\"cost_calculated_per_rlevel\",\"label\":\"cost_calculated_per_rlevel\",\"connectionName\":\"Heroku\",\"type\":\"connectedDataset\"}}},\"LOAD_DATASET1\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"External_ID\",\"Product_Category\",\"Customer_Key\",\"Customer_Name\",\"Material_Number\",\"Business_Area\",\"Created_Date\",\"Quantity_t\",\"Net_Proceeds\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"name\":\"COPA_dashboard\",\"label\":\"COPA\",\"type\":\"analyticsDataset\"}}},\"TO_DATE0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"Forecast_Date\"]},\"fields\":[{\"newProperties\":{\"name\":\"Forecast_Date\"},\"name\":\"Forecast_Date_to_date\"}]},\"sources\":[\"FORMULA4\"],\"action\":\"typeCast\",\"parameters\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"format\":\"yyyy-M-d\",\"type\":\"DATETIME\"},\"name\":\"Forecast_Date_to_date\",\"label\":\"Forecast Date\"},\"name\":\"Forecast_Date\"}]}},\"TO_DATE1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"ForecastTimePoint__c\"]},\"fields\":[{\"newProperties\":{\"name\":\"ForecastTimePoint__c\"},\"name\":\"ForecastTimePoint__c_to_date\"}]},\"sources\":[\"FORMULA8\"],\"action\":\"typeCast\",\"parameters\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"format\":\"dd/MM/yyyy\",\"type\":\"DATETIME\"},\"name\":\"ForecastTimePoint__c_to_date\",\"label\":\"Forecast Time Point\"},\"name\":\"ForecastTimePoint__c\"}]}},\"FORMULA0\":{\"sources\":[\"AGGREGATE3\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_Net_Proceeds / SUM_Quantity_t\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Weighted_NE_per_Ton\",\"scale\":2,\"label\":\"Weighted NE per Ton\",\"type\":\"NUMBER\"}]}},\"FORMULA1\":{\"sources\":[\"JOIN0\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_Quantity_t / \\\"Aggregate4.SUM_Quantity_t\\\"\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Percentage_Quantity\",\"scale\":5,\"label\":\"Percentage Quantity\",\"type\":\"NUMBER\"}]}},\"FORMULA2\":{\"sources\":[\"FILTER9\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_external_cost + \\r\\n(\\\"HZV.SUM_external_cost\\\" + \\r\\n(\\\"SW.SUM_external_cost\\\" * (\\\"HZV.AVG_quantity_child_material\\\" / 1000))) *\\r\\n(AVG_quantity_child_material / 1000)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Total_External_Cost\",\"scale\":2,\"label\":\"Total External Cost\",\"type\":\"NUMBER\"}]}},\"FILTER8\":{\"sources\":[\"JOIN0_copy0\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":0,\"type\":\"N_MONTHS\"},{\"argument\":11,\"type\":\"N_MONTHS\"}],\"field\":\"ForecastTimePoint__c\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"FORMULA3\":{\"sources\":[\"FORMULA2\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_internal_cost + \\r\\n(\\\"HZV.SUM_internal_cost\\\" + \\r\\n(\\\"SW.SUM_internal_cost\\\" * (\\\"HZV.AVG_quantity_child_material\\\" / 1000))) *\\r\\n(AVG_quantity_child_material / 1000)\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Total_Internal_Cost\",\"scale\":2,\"label\":\"Total Internal Cost\",\"type\":\"NUMBER\"}]}},\"FILTER9\":{\"sources\":[\"JOIN6\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[],\"field\":\"HZV.material_no\",\"type\":\"TEXT\",\"operator\":\"IS_NOT_NULL\"},{\"operands\":[],\"field\":\"SW.material_no\",\"type\":\"TEXT\",\"operator\":\"IS_NOT_NULL\"}]}},\"FORMULA4\":{\"sources\":[\"DROP_FIELDS1\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"concat(price_point_year, '-', price_point_month, '-01')\",\"defaultValue\":\"\",\"precision\":255,\"name\":\"Forecast_Date\",\"label\":\"Forecast Date\",\"type\":\"TEXT\"}]}},\"FORMULA5\":{\"sources\":[\"JOIN4\"],\"action\":\"formula\",\"parameters\":{\"expressionType\":\"SQL\",\"fields\":[{\"formulaExpression\":\"SUM_ForecastSoldAmount__c * Percentage_Quantity\",\"defaultValue\":\"\",\"precision\":10,\"name\":\"Forecast_Quantity\",\"scale\":2,\"label\":\"Forecast Quantity\",\"type\":\"NUMBER\"}]}},\"FILTER4\":{\"sources\":[\"LOAD_DATASET3\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[\"0\",\"Q1\",\"Q2\",\"Q3\",\"Q4\"],\"field\":\"price_point_month\",\"type\":\"TEXT\",\"operator\":\"NOT\"},{\"operands\":[\"0\"],\"field\":\"alternate_basic_plan\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"}]}},\"FILTER5\":{\"sources\":[\"JOIN0_copy0\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":-1,\"type\":\"N_MONTHS\"},{\"argument\":-1,\"type\":\"N_MONTHS\"}],\"field\":\"ForecastTimePoint__c\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"AGGREGATE9\":{\"sources\":[\"EXTRACT4\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"material_no\",\"child_material_no\",\"price_point_year\",\"price_point_month\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_external_cost\",\"action\":\"SUM\",\"source\":\"external_cost\",\"label\":\"Sum of external_cost\"},{\"name\":\"SUM_internal_cost\",\"action\":\"SUM\",\"source\":\"internal_cost\",\"label\":\"Sum of internal_cost\"},{\"name\":\"AVG_quantity_child_material\",\"action\":\"AVG\",\"source\":\"quantity_child_material\",\"label\":\"Average quantity_child_material\"}]}},\"FILTER7\":{\"sources\":[\"FILTER1_copy0\"],\"action\":\"sqlFilter\",\"parameters\":{\"sqlFilterExpression\":\"(child_material_no IS NOT NULL) AND (substr(child_material_no, 0, 4) != string(1000))\"}},\"FILTER0\":{\"sources\":[\"LOAD_DATASET1\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[{\"argument\":-1,\"type\":\"N_MONTHS\"},{\"argument\":-1,\"type\":\"N_MONTHS\"}],\"field\":\"Created_Date\",\"type\":\"DATETIME\",\"operator\":\"IN_RANGE\"}]}},\"TO_DATE2\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"COPA_Last_Updated_Date\"]},\"fields\":[{\"newProperties\":{\"name\":\"COPA_Last_Updated_Date\"},\"name\":\"Last_Updated_Date_to_date\"}]},\"sources\":[\"FORMULA9\"],\"action\":\"typeCast\",\"parameters\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"format\":\"dd/MM/yyyy\",\"type\":\"DATETIME\"},\"name\":\"Last_Updated_Date_to_date\",\"label\":\"Last Updated Date\"},\"name\":\"COPA_Last_Updated_Date\"}]}},\"AGGREGATE3\":{\"schema\":{\"fields\":[{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_Quantity_t\"},{\"newProperties\":{\"typeProperties\":{\"precision\":18,\"scale\":2,\"type\":\"NUMBER\"}},\"name\":\"SUM_Net_Proceeds\"}]},\"sources\":[\"EXTRACT1\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Material_Number\",\"Customer_Name\",\"Business_Area\",\"Created_Date_MONTH\",\"Created_Date_YEAR\",\"Customer_Key\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_Quantity_t\",\"action\":\"SUM\",\"source\":\"Quantity_t\",\"label\":\"Sum of Quantity (t)\"},{\"name\":\"SUM_Net_Proceeds\",\"action\":\"SUM\",\"source\":\"Net_Proceeds\",\"label\":\"Sum of Net Proceeds\"}]}},\"AGGREGATE5\":{\"sources\":[\"EXTRACT2\"],\"action\":\"aggregate\",\"parameters\":{\"groupings\":[\"Customer_Name\",\"Customer_Key\"],\"pivots\":[],\"nodeType\":\"STANDARD\",\"aggregations\":[{\"name\":\"SUM_Quantity_t\",\"action\":\"SUM\",\"source\":\"Quantity_t\",\"label\":\"Sum of Quantity (t)\"}]}},\"LOAD_DATASET0_copy0\":{\"sources\":[],\"action\":\"load\",\"parameters\":{\"fields\":[\"Account__c\",\"BusinessArea__c\",\"ForecastTimePoint__c\",\"ForecastSoldAmount__c\",\"ForecastNetProceeds__c\",\"ForecastLevel__c\",\"Frequency__c\",\"ActualNetProceeds__c\"],\"sampleDetails\":{\"sortBy\":[],\"type\":\"TopN\"},\"dataset\":{\"sourceObjectName\":\"SalesPlanning__c\",\"label\":\"SalesPlanning__c\",\"connectionName\":\"SFDC_LOCAL\",\"type\":\"connectedDataset\"}}},\"FILTER0_copy0\":{\"sources\":[\"LOAD_DATASET0_copy0\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[\"Account\"],\"field\":\"ForecastLevel__c\",\"type\":\"TEXT\",\"operator\":\"EQUAL\"},{\"operands\":[\"Yearly\"],\"field\":\"Frequency__c\",\"type\":\"TEXT\",\"operator\":\"NOT\"}]}},\"JOIN1\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN7\",\"TO_DATE2\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"SAPAccountNumber__c\"],\"rightKeys\":[\"Customer_Key\"],\"joinType\":\"INNER\"}},\"JOIN0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"FORMULA0\",\"AGGREGATE5\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Customer_Key\"],\"rightQualifier\":\"Aggregate4\",\"rightKeys\":[\"Customer_Key\"],\"joinType\":\"LOOKUP\"}},\"JOIN0_copy0\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"DROP_FIELDS5\",\"LOAD_DATASET1_copy0\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Account__c\"],\"rightKeys\":[\"Id\"],\"joinType\":\"LOOKUP\"}},\"FILTER1_copy0\":{\"sources\":[\"AGGREGATE9\"],\"action\":\"filter\",\"parameters\":{\"filterExpressions\":[{\"operands\":[\"1000\"],\"field\":\"material_no\",\"type\":\"TEXT\",\"operator\":\"STARTS_WITH\"}]}},\"JOIN7\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[\"LastMonth.Account__c\",\"LastMonth.ForecastTimePoint__c\"]},\"fields\":[]},\"sources\":[\"FILTER8\",\"DROP_FIELDS4\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Account__c\"],\"rightQualifier\":\"LastMonth\",\"rightKeys\":[\"Account__c\"],\"joinType\":\"LOOKUP\"}},\"EXTRACT5\":{\"sources\":[\"FILTER0_copy0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[{\"source\":\"ForecastTimePoint__c\",\"targets\":[{\"name\":\"ForecastTimePoint__c_MONTH\",\"label\":\"Forecast Time point Month\",\"grainType\":\"MONTH\"},{\"name\":\"ForecastTimePoint__c_YEAR\",\"label\":\"Forecast Time point Year\",\"grainType\":\"YEAR\"}]}]}},\"JOIN6\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"JOIN5\",\"AGGREGATE9\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"HZV.child_material_no\",\"HZV.price_point_year\",\"price_point_month\"],\"rightQualifier\":\"SW\",\"rightKeys\":[\"material_no\",\"price_point_year\",\"price_point_month\"],\"joinType\":\"LOOKUP\"}},\"JOIN5\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"FILTER7\",\"AGGREGATE9\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"child_material_no\",\"price_point_year\",\"price_point_month\"],\"rightQualifier\":\"HZV\",\"rightKeys\":[\"material_no\",\"price_point_year\",\"price_point_month\"],\"joinType\":\"LOOKUP\"}},\"JOIN4\":{\"schema\":{\"slice\":{\"mode\":\"DROP\",\"ignoreMissingFields\":true,\"fields\":[]},\"fields\":[]},\"sources\":[\"DROP_FIELDS0\",\"DROP_FIELDS2\"],\"action\":\"join\",\"parameters\":{\"leftKeys\":[\"Material_Number\",\"ForecastTimePoint__c\"],\"rightKeys\":[\"material_no\",\"Forecast_Date\"],\"joinType\":\"LOOKUP\"}},\"EXTRACT4\":{\"sources\":[\"FILTER4\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}},\"EXTRACT1\":{\"sources\":[\"FILTER0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[{\"source\":\"Created_Date\",\"targets\":[{\"name\":\"Created_Date_MONTH\",\"label\":\"Created Date Month\",\"grainType\":\"MONTH\"},{\"name\":\"Created_Date_YEAR\",\"label\":\"Created Date Year\",\"grainType\":\"YEAR\"}]}]}},\"EXTRACT2\":{\"sources\":[\"FILTER0\"],\"action\":\"extractGrains\",\"parameters\":{\"grainExtractions\":[]}}},\"ui\":{\"hiddenColumns\":[],\"connectors\":[{\"source\":\"FILTER7\",\"target\":\"JOIN5\"},{\"source\":\"TRANSFORM7\",\"target\":\"JOIN0_copy0\"},{\"source\":\"JOIN7\",\"target\":\"JOIN1\"},{\"source\":\"LOAD_DATASET1\",\"target\":\"FILTER0\"},{\"source\":\"FILTER0\",\"target\":\"AGGREGATE2\"},{\"source\":\"AGGREGATE2\",\"target\":\"TRANSFORM0\"},{\"source\":\"FILTER0\",\"target\":\"AGGREGATE4\"},{\"source\":\"TRANSFORM0\",\"target\":\"JOIN0\"},{\"source\":\"AGGREGATE4\",\"target\":\"JOIN0\"},{\"source\":\"JOIN0\",\"target\":\"TRANSFORM1\"},{\"source\":\"TRANSFORM1\",\"target\":\"JOIN1\"},{\"source\":\"JOIN1\",\"target\":\"TRANSFORM2\"},{\"source\":\"TRANSFORM2\",\"target\":\"JOIN4\"},{\"source\":\"TRANSFORM4\",\"target\":\"JOIN4\"},{\"source\":\"LOAD_DATASET1_copy0\",\"target\":\"JOIN0_copy0\"},{\"source\":\"TRANSFORM3\",\"target\":\"TRANSFORM4\"},{\"source\":\"LOAD_DATASET3\",\"target\":\"FILTER4\"},{\"source\":\"FILTER4\",\"target\":\"AGGREGATE8\"},{\"source\":\"AGGREGATE8\",\"target\":\"FILTER1_copy0\"},{\"source\":\"AGGREGATE8\",\"target\":\"JOIN5\"},{\"source\":\"JOIN5\",\"target\":\"JOIN6\"},{\"source\":\"AGGREGATE8\",\"target\":\"JOIN6\"},{\"source\":\"LOAD_DATASET0_copy0\",\"target\":\"FILTER0_copy0\"},{\"source\":\"JOIN4\",\"target\":\"TRANSFORM5\"},{\"source\":\"TRANSFORM5\",\"target\":\"OUTPUT0\"},{\"source\":\"JOIN0_copy0\",\"target\":\"FILTER5\"},{\"source\":\"FILTER5\",\"target\":\"TRANSFORM6\"},{\"source\":\"FILTER8\",\"target\":\"JOIN7\"},{\"source\":\"TRANSFORM6\",\"target\":\"JOIN7\"},{\"source\":\"FILTER0_copy0\",\"target\":\"AGGREGATE10\"},{\"source\":\"AGGREGATE10\",\"target\":\"TRANSFORM7\"},{\"source\":\"FILTER1_copy0\",\"target\":\"FILTER7\"},{\"source\":\"JOIN0_copy0\",\"target\":\"FILTER8\"},{\"source\":\"JOIN6\",\"target\":\"FILTER9\"},{\"source\":\"FILTER9\",\"target\":\"TRANSFORM3\"}],\"nodes\":{\"AGGREGATE10\":{\"connectors\":[{\"source\":\"EXTRACT5\",\"target\":\"AGGREGATE11\"}],\"top\":112.1,\"left\":392,\"description\":\"\",\"label\":\"Aggregate all business areas for each account\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE11\":null,\"EXTRACT5\":null}},\"LOAD_DATASET1_copy0\":{\"top\":252.7,\"left\":112.6,\"label\":\"Account\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"TRANSFORM4\":{\"connectors\":[{\"source\":\"FORMULA4\",\"target\":\"TO_DATE0\"},{\"source\":\"TO_DATE0\",\"target\":\"DROP_FIELDS2\"}],\"top\":951.5,\"left\":1232.2,\"description\":\"Convert the price point forecast field into a date field that can be used by CRM Analytics.\",\"label\":\"Transform strings into date\",\"type\":\"TRANSFORM\",\"graph\":{\"TO_DATE0\":{\"label\":\"To Date\"},\"DROP_FIELDS2\":{\"label\":\"Drop Columns\"},\"FORMULA4\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"TRANSFORM5\":{\"connectors\":[{\"source\":\"FORMULA5\",\"target\":\"FORMULA6\"},{\"source\":\"FORMULA6\",\"target\":\"FORMULA7\"},{\"source\":\"FORMULA7\",\"target\":\"DROP_FIELDS3\"}],\"top\":393.4,\"left\":1372,\"description\":\"Node used to create the Quantity Sold, NE and PE forecasted for the next 12 months for each Material Number.\",\"label\":\"Create KPIs\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA6\":{\"label\":\"Create Forecast NE\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA7\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"DROP_FIELDS3\":{\"label\":\"Drop Columns\"},\"FORMULA5\":{\"label\":\"Create Forecast Quantity\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"OUTPUT0\":{\"top\":392.2,\"left\":1512.8,\"description\":\"\",\"label\":\"Create Net Proceeds dataset\",\"type\":\"OUTPUT\"},\"TRANSFORM6\":{\"connectors\":[],\"top\":112,\"left\":812,\"description\":\"\",\"label\":\"Remove redundant columns\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS4\":{\"label\":\"Drop Columns\"}}},\"LOAD_DATASET3\":{\"top\":672.7,\"left\":112.5,\"description\":\"Pull the cost calculated per R-Level data from Heroku\",\"label\":\"cost_calculated_per_rlevel\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":10000}},\"TRANSFORM7\":{\"connectors\":[{\"source\":\"FORMULA8\",\"target\":\"TO_DATE1\"},{\"source\":\"TO_DATE1\",\"target\":\"DROP_FIELDS5\"}],\"top\":112.1,\"left\":532,\"description\":\"Transform the forecast time point into a date field that can be used by CRM Analytics\",\"label\":\"Get forecast time point in a date field\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA8\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"TO_DATE1\":{\"label\":\"To Date\"},\"DROP_FIELDS5\":{\"label\":\"Drop Columns\"}}},\"LOAD_DATASET1\":{\"top\":392.7,\"left\":112.5,\"label\":\"COPA\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":2000}},\"TRANSFORM0\":{\"connectors\":[],\"top\":392.7,\"left\":532.5,\"label\":\"Calculate Weighted NE per Ton\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA0\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"FILTER8\":{\"top\":252,\"left\":812,\"description\":\"Sales Planning is for 12 months in the future only, so remove data older than 12 months.\",\"label\":\"Only include 12 months worth of forecasts\",\"type\":\"FILTER\"},\"TRANSFORM1\":{\"connectors\":[{\"source\":\"FORMULA1\",\"target\":\"FORMULA9\"},{\"source\":\"FORMULA9\",\"target\":\"TO_DATE2\"}],\"top\":392.7,\"left\":812.5,\"description\":\"The percentage quantity is the division of each material quantity to the total quantity for that account.\",\"label\":\"Calculate percentage quantity for each Material\",\"type\":\"TRANSFORM\",\"graph\":{\"FORMULA9\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"TO_DATE2\":{\"label\":\"To Date\"},\"FORMULA1\":{\"label\":\"Formula\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"FILTER9\":{\"top\":953.3,\"left\":952,\"description\":\"This step excludes all recipes that do not have the HZV or SW\",\"label\":\"Exclude incorrect recipes (2/2)\",\"type\":\"FILTER\"},\"TRANSFORM2\":{\"connectors\":[],\"top\":392.7,\"left\":1092.5,\"description\":\"\",\"label\":\"Drop columns not used\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS0\":{\"label\":\"Drop Columns\"}}},\"TRANSFORM3\":{\"connectors\":[{\"source\":\"FORMULA2\",\"target\":\"FORMULA3\"},{\"source\":\"FORMULA3\",\"target\":\"DROP_FIELDS1\"}],\"top\":951.6,\"left\":1091.8,\"description\":\"Calculate for both internal and external cost the total cost for a single FMN, aggregating the FMN, HZV and SW costs into one row.\",\"label\":\"Create total external and internal costs\",\"type\":\"TRANSFORM\",\"graph\":{\"DROP_FIELDS1\":{\"label\":\"Drop Columns\"},\"FORMULA2\":{\"label\":\"Calculate total external cost\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}},\"FORMULA3\":{\"label\":\"Calculate total internal cost\",\"parameters\":{\"type\":\"BASE_FORMULA_UI\"}}}},\"FILTER4\":{\"top\":672.1,\"left\":252,\"description\":\"Remove quarterly data, as only monthly data is needed. Also remove all records that have the alternate basic plan data.\",\"label\":\"Remove Quarter data\",\"type\":\"FILTER\"},\"AGGREGATE8\":{\"connectors\":[{\"source\":\"EXTRACT4\",\"target\":\"AGGREGATE9\"}],\"top\":672,\"left\":391.9,\"description\":\"Aggregate the R-Levels to one row per phase of production and price point year and month\",\"label\":\"Aggregate R-Levels to phase of production (FMN / HZV / SW)\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE9\":null,\"EXTRACT4\":null}},\"FILTER5\":{\"top\":113.30000000000001,\"left\":672,\"description\":\"Extract from the Sales Planning dataset the Actual Net Proceeds just for last month. This will be used in the NE calculation.\",\"label\":\"Get Actual Net Proceeds from last month\",\"type\":\"FILTER\"},\"FILTER7\":{\"top\":672.2,\"left\":672,\"description\":\"This step excludes recipes that have the child_material_no equal to null and that have the child material being a FMN\",\"label\":\"Exclude incorrect recipes (1/2)\",\"type\":\"FILTER\"},\"FILTER0\":{\"top\":392.7,\"left\":252.5,\"description\":\"\",\"label\":\"Filter COPA data for current month\",\"type\":\"FILTER\"},\"AGGREGATE2\":{\"connectors\":[{\"source\":\"EXTRACT1\",\"target\":\"AGGREGATE3\"}],\"top\":392.7,\"left\":392.5,\"description\":\"Aggregate the quantity sold and NE at the Material Level\",\"label\":\"Aggregate Quantitiy and NE to Material Number lvl\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE3\":null,\"EXTRACT1\":null}},\"AGGREGATE4\":{\"connectors\":[{\"source\":\"EXTRACT2\",\"target\":\"AGGREGATE5\"}],\"top\":532.7,\"left\":392.5,\"description\":\"Aggregate the quantity sold at the Account level\",\"label\":\"Aggregate Quantity of each Account\",\"type\":\"AGGREGATE\",\"graph\":{\"AGGREGATE5\":null,\"EXTRACT2\":null}},\"LOAD_DATASET0_copy0\":{\"top\":112.69999999999999,\"left\":112.6,\"label\":\"SalesPlanning__c\",\"type\":\"LOAD_DATASET\",\"parameters\":{\"sampleSize\":10000}},\"FILTER0_copy0\":{\"top\":112.1,\"left\":251.89999999999998,\"description\":\"Exclude business area sales planning information\",\"label\":\"Only include account Sales Planning record\",\"type\":\"FILTER\"},\"JOIN1\":{\"top\":392.7,\"left\":952.5,\"description\":\"Join the COPA data with the Sales Planning data using the SAP Account Number as key.\",\"label\":\"Inner join with Sales Planning data\",\"type\":\"JOIN\"},\"JOIN0\":{\"top\":392.7,\"left\":672.5,\"description\":\"Join each row of material level aggregated data with the total quantity sold of each Account to which the material has been sold.\",\"label\":\"Join Weighted NE data and Total Account qt sold\",\"type\":\"JOIN\"},\"JOIN0_copy0\":{\"top\":252.2,\"left\":532,\"description\":\"\",\"label\":\"Add SAP ID\",\"type\":\"JOIN\"},\"FILTER1_copy0\":{\"top\":672.1,\"left\":532,\"description\":\"Include only the FMN phase of production\",\"label\":\"FMN\",\"type\":\"FILTER\"},\"JOIN7\":{\"top\":252.10000000000002,\"left\":952,\"description\":\"Join the actual net proceeds for last month to the Sales Planning (aggregated to the account level) dataset\",\"label\":\"Add actual net proceeds\",\"type\":\"JOIN\"},\"JOIN6\":{\"top\":951.7,\"left\":811.9,\"description\":\"Put on one single row a FMN, HZV and its corresponding SW\",\"label\":\"SW\",\"type\":\"JOIN\"},\"JOIN5\":{\"top\":812,\"left\":672.1,\"description\":\"Put on one single row a FMN and its corresponding HZV\",\"label\":\"HZV\",\"type\":\"JOIN\"},\"JOIN4\":{\"top\":392.7,\"left\":1232.5,\"description\":\"Join the COPA and Sales Planning data to the R-Level cost of production data using the material number as key.\",\"label\":\"Join forecast cost of production\",\"type\":\"JOIN\"}}},\"version\":\"58.0\",\"runMode\":\"full\"}"]